---
title: "API"
---

# API

<div class="article-intro">

API ChurchApps — это **модульный монолит**: единая кодовая база, обслуживающая шесть отдельных модулей, каждый со своей базой данных. Такая архитектура даёт организационные преимущества микросервисов (чёткие границы, независимые хранилища данных) при операционной простоте единого развёртывания.

</div>

## Модули

| Модуль | Назначение |
|--------|---------|
| **Membership** | Люди, группы, домохозяйства, разрешения |
| **Attendance** | Служения, сессии, записи регистрации |
| **Content** | Страницы, разделы, элементы, трансляции |
| **Giving** | Пожертвования, фонды, обработка платежей |
| **Messaging** | Переписки, уведомления, электронная почта |
| **Doing** | Задачи, планы, назначения |

## Технологический стек

- **Среда выполнения:** Node.js 22.x с TypeScript (ES-модули)
- **Фреймворк:** Express
- **Внедрение зависимостей:** Inversify (маршрутизация на основе декораторов)
- **База данных:** MySQL -- одна база данных на модуль, каждая со своим пулом соединений
- **Аутентификация:** JWT-аутентификация через `CustomAuthProvider`
- **Развёртывание:** AWS Lambda через Serverless Framework v3

## Порты

| Протокол | Порт | Описание |
|----------|------|-------------|
| HTTP | `8084` | Основной REST API |
| WebSocket | `8087` | Соединения реального времени |

## Lambda-функции

При развёртывании в AWS API работает как четыре Lambda-функции:

- **`web`** -- Обрабатывает все HTTP-запросы
- **`socket`** -- Управляет WebSocket-соединениями
- **`timer15Min`** -- Запускается каждые 15 минут для уведомлений по электронной почте
- **`timerMidnight`** -- Запускается ежедневно для дайджестов и задач обслуживания

## Общие библиотеки

API зависит от двух общих пакетов ChurchApps:

- **[`@churchapps/helpers`](../shared-libraries/helpers)** -- Базовые утилиты (DateHelper, ApiHelper и др.)
- **[`@churchapps/apihelper`](../shared-libraries/api-helper)** -- Утилиты для Express-сервера, включая аутентификацию, хелперы базы данных и интеграции с AWS

:::info
API использует ES-модули (`"type": "module"` в `package.json`). Убедитесь, что ваши импорты используют синтаксис ES-модулей.
:::

## В этом разделе

- **[Локальная настройка](./local-setup)** -- Клонирование, настройка и запуск API локально
- **[База данных](./database)** -- Архитектура «одна БД на модуль», скрипты схемы и паттерны доступа к данным
- **[Структура модулей](./module-structure)** -- Контроллеры, репозитории, модели и аутентификация
- **[Справочник по эндпоинтам](./endpoints/)** -- Полная документация REST API для всех модулей
